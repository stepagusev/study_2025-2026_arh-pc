---
## Author
author:
  name: Гусев Степан Андреевич
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: 1032242444@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6

## Title
title: "Отчёт по лабораторной работе №5"
subtitle: "Дисциплина: Архитектура компьютеров и операционные системы"
license: "CC BY"
---

# Цель работы

Научиться работать в Midnight Commander, освоить инструкции языка ассемблера mov и int.

# Задание

1. Основы работы с mc
2. Подключение внешнего файла in_out.asm
3. Задание для самостоятельной работы

# Теоретическое введение

Midnight Commander (или просто mc) — это программа, которая позволяет просматривать структуру каталогов и выполнять основные операции по управлению файловой системой, т.е. mc является файловым менеджером. Midnight Commander позволяет сделать работу с файлами более удобной и наглядной. Программа на языке ассемблера NASM, как правило, состоит из трёх секций: секция кода программы (SECTION .text), секция инициированных (известных во время компиляции) данных (SECTION .data) и секция неинициализированных данных (тех, под которые во время компиляции только отводится память, а значение присваивается в ходе выполнения программы) (SECTION .bss). Для объявления инициированных данных в секции .data используются директивы DB, DW, DD, DQ и DT, которые резервируют память и указывают, какие значения должны храниться в этой памяти:

DB (define byte) — определяет переменную размером в 1 байт;
DW (define word) — определяет переменную размеров в 2 байта (слово);
DD (define double word) — определяет переменную размером в 4 байта (двойное слово);
DQ (define quad word) — определяет переменную размером в 8 байт (учетве- рённое слово);
DT (define ten bytes) — определяет переменную размером в 10 байт. Директивы используются для объявления простых переменных и для объявления массивов. Для определения строк принято использовать директиву DB в связи с особенностями хранения данных в оперативной памяти. Инструкция языка ассемблера mov предназначена для дублирования данных источника в приёмнике.

mov dst,src

Здесь операнд dst — приёмник, а src — источник. В качестве операнда могут выступать регистры (register), ячейки памяти (memory) и непосредственные значения (const). Инструкция языка ассемблера intпредназначена для вызова прерывания с указанным номером.
int n

Здесь n — номер прерывания, принадлежащий диапазону 0–255. При программировании в Linux с использованием вызовов ядра sys_calls n=80h (принято задавать в шестнадцатеричной системе счисления).

# Выполнение лабораторной работы

## Основы работы с mc

Открыл Midnight Commander ([рис. @fig-001]).

![Открытие mc](image/img1.png){#fig-001 width=70%}

Перешёл в каталог, созданный при выполнении лабораторной работы №4 ([рис. @fig-002]).

![Перемещение между директориями](image/img2.png){#fig-002 width=70%}

С помощью F7 создал папку lab05 и перешёл в неё ([рис. @fig-003]).

![Создание папки](image/img3.png){#fig-003 width=70%}

Создал файл lab5-1.asm с помощью утилиты touch ([рис. @fig-004]), ([рис. @fig-005]).

![Создание файла](image/img4.png){#fig-004 width=70%}

![Файл создан](image/img5.png){#fig-005 width=70%}

С помощью F4 открыл файл lab5-1.asm для редактирования в текстовом редакторе nano ([рис. @fig-006]).

![Открытие файла](image/img6.png){#fig-006 width=70%}

Ввёл данный текст ([рис. @fig-007]). Сохранил изменения комбинацией клавиш ctrl + o и закрыл файл с помощью ctrl + x.

![Введение текста](image/img7.png){#fig-007 width=70%}

С помощью F3 открыл файл lab5-1.asm для просмотра и убедился, что введёный текст сохранился ([рис. @fig-008]).

![Проверка](image/img8.png){#fig-008 width=70%}

Оттранслировал текст программы lab5-1.asm в объектный файл и выполнил компоновку объектного файла ([рис. @fig-009])

![Обработка файла](image/img9.png){#fig-009 width=70%}

Запустил получившийся исполняемый файл ([рис. @fig-010]). Программа выводит строку 'Введите строку: ' и ожидает ввода с клавиатуры. На запрос ввёл ФИО.  

![Запуск программы](image/img10.png){#fig-010 width=70%}

## Подключение внешнего файла in_out.asm

Скачал файл in_out.asm ([рис. @fig-011]).

![Загрузки](image/img11.png){#fig-011 width=70%}

Переместил файл in_out.asm с помощью F5 ([рис. @fig-012]).

![Перемещение файла](image/img12.png){#fig-012 width=70%}

С помощью F6 создал копию файла lab5-1.asm с именем lab5-2.asm ([рис. @fig-013]).

![Копирование файла](image/img13.png){#fig-013 width=70%}

Исправил текст программы в файле lab5-2.asm с использованием подпрограмм из внешнего файла in_out.asm([рис. @fig-014]).

![Изменение файла](image/img14.png){#fig-014 width=70%}

Оттранслировал текст программы lab5-2.asm в объектный файл, выполнил компоновку объектного файла и запустил получившийся исполняемый файл ([рис. @fig-015]).

![Обработка файла](image/img15.png){#fig-015 width=70%}

В файле lab5-2.asm заменил sprintLF на sprint ([рис. @fig-016]).

![Копирование файлов](image/img16.png){#fig-016 width=70%}

Оттранслировал текст программы lab5-2.asm в объектный файл, выполнил компоновку объектного файла и запустил получившийся исполняемый файл ([рис. @fig-017]). Изменилось поведение курсора: в первом случае после вывода 'Введите строку: ' курсор переносится на следующую строку, во втором же - курсор остаётся на той же строке.

![Обработка файла](image/img17.png){#fig-017 width=70%}

## Задание для самостоятельной работы

Создал копию файла lab5-1.asm с именем lab5-1-copy.asm. В новом файле изменил текст программы без использования внешнего файла так, чтобы кроме вывода текста и ввода в конце вывелась введённая строка [рис. @fig-018]).

![Изменённый файл](image/img18.png){#fig-018 width=70%}

Оттранслировал текст программы lab5-1-copy.asm в объектный файл, выполнил компоновку объектного файла и запустил получившийся исполняемый файл, введя свою фамилию [рис. @fig-019]).

![Запуск программы](image/img19.png){#fig-019 width=70%}

Создал копию файла lab5-2.asm с именем lab-2-copy.asm. В новом файле изменил текст программы без использования внешнего файла так, чтобы кроме вывода текста и ввода в конце вывелась введённая строка [рис. @fig-018]).

![Изменённый файл](image/img20.png){#fig-020 width=70%}

Оттранслировал текст программы lab-2-copy.asm в объектный файл, выполнил компоновку объектного файла и запустил получившийся исполняемый файл, введя свою фамилию [рис. @fig-021]).

![Запуск программы](image/img21.png){#fig-021 width=70%}

# Выводы

При выполнении данной лабораторной работы я приобрел практические навыки работы в Midnight Commander, а также освоил инструкции языка ассемблера mov и int.

# Список литературы

1. [Архитектура ЭВМ](https://esystem.rudn.ru/mod/resource/view.php?id=1032151)
